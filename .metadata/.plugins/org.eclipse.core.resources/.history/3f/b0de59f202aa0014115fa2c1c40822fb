package com.iiitb.utility;

import java.io.ObjectInputStream.GetField;
import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.NodeList;

import com.iiitb.blocks.*;

public class FetchInputFromLine {

	public static Block parseLine(ArrayList<Block> blockList, NodeList attributes) {
		// TODO Auto-generated method stub

		for (int iter = 0; iter < attributes.getLength(); iter++) {
			String sourceNode = "";
			String destNode = "";

			if (attributes.item(iter).getNodeName() == "P")

			{

				NamedNodeMap temp = attributes.item(iter).getAttributes();

				for (int tempIter = 0; tempIter < temp.getLength(); tempIter++) {
					
					System.out.println("Testing :" +temp.item(tempIter).getNodeValue());
					if (temp.item(tempIter).getNodeValue()
							.equalsIgnoreCase("SrcBlock")) {

						sourceNode = attributes.item(iter).getTextContent();
						System.out.println("src "+sourceNode);
						
					}

					if (temp.item(tempIter).getNodeValue()
							.equalsIgnoreCase("DstBlock")) {

						destNode = attributes.item(iter).getTextContent();
						System.out.println("dest "+destNode);
					}

				}

				if (sourceNode != "" && destNode != "") {

					Iterator blockListIter = blockList.iterator();
					
					while (blockListIter.hasNext()) {
						
						Block blockObj = (Block) blockListIter.next();
						if (destNode.equalsIgnoreCase(blockObj.getName())) {
							blockObj.setInput(sourceNode);
							//blockList.remove(i);
							//blockList.add(i, blockObj);
							if(blockObj.isInputSetFlag())
							{
								
								List<String> input = new ArrayList<String>();
								input = blockObj.getInput();
								blockObj.getAccfg().setInput(input);
								List<String> expr = new ArrayList<String>();
								expr.add(blockObj.expression());
								blockObj.getAccfg().setFp(expr);
								
								
							}
							
						}
						

					}

				}

			}

		}
		return null;
	}

}
